<?

foreach($this->scs as $sc_id=>$sc_a) {
    $sc = $sc_a[0];

    $name = $sc->name;
    $ex_class = "";
    if($sc->disable == 1) {
        $name .= " (Removed)";
        $ex_class = "disabled";
    }
    if($sc->active == 0) {
        $name .= " (Inactive)";
    }

    echo "<div class=\"support_center round\">";
    echo "<span class=\"h3\">".$name."</span>";
    if(isset($_REQUEST["summary_attrs_showdesc"])) {
        echo "<br/>";
        echo htmlentities($sc->description);
    }
    echo "</div>";

    echo "<table class='summary_table'>";
    echo "<tr><th>Long Name</th><td>".htmlentities(@$sc->long_name)."</td></tr>";
    echo "<tr><th>Community</th><td>".htmlentities(@$sc->community)."</td></tr>";

    if(isset($_REQUEST["summary_attrs_showcontact"])) {
        echo "<tr><th>Contacts</th><td>";
        if(isset($this->contacts[$sc_id])) {
            $contact_types = $this->contacts[$sc_id];
            foreach($contact_types as $type_name=>$contacts) {
                echo "<h4>$type_name</h4>";
                foreach($contacts as $contact) {
                    if(user()->isGuest()) {
                        echo htmlentities($contact->name)."<br/>";
                    } else {
                        echo "<div class=\"contact_info\">";
                        echo "<h3>".htmlentities($contact->name)."</h3>";
                        echo "<table class=\"summary_subtable\">"; 
                        echo "<tr><th>Email</th><td>".emailaddress($contact->primary_email)."</td></tr>";
                        echo "<tr><th>Phone</th><td>".htmlentities($contact->primary_phone)."</td></tr>";
                        echo "</table>";
                        echo "</div>";
                    }
                }
            }
        }
        echo "</td></tr>";
    }


    echo "</td></tr>";
    echo "</table>";
}
